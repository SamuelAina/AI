CREATE FUNCTION dbo.ExtractBeforeFirstSpace (@inputString NVARCHAR(MAX))
RETURNS NVARCHAR(MAX)
AS
BEGIN
    DECLARE @spacePosition INT;
    DECLARE @result NVARCHAR(MAX);

    -- Find the position of the first space character
    SET @spacePosition = CHARINDEX(' ', @inputString);

    -- If there's no space, return the original string
    IF @spacePosition = 0
    BEGIN
        SET @result = @inputString;
    END
    ELSE
    BEGIN
        -- Extract substring before the first space
        SET @result = SUBSTRING(@inputString, 1, @spacePosition - 1);
    END

    RETURN @result;
END;
